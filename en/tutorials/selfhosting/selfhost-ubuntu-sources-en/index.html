



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Cozy documentation">
      
      
        <link rel="canonical" href="https://docs.cozy.io/tutorials/selfhosting/selfhost-ubuntu-sources-en/">
      
      
        <meta name="author" content="CozyCloud - https://cozy.io">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[^a-zа-яё0-9\-\.]">
      
      <link rel="shortcut icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>on Ubuntu from sources (en) - Cozy Developer Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../../../assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
    
      <script src="../../../assets/javascripts/modernizr.74668098.js"></script>
    
    <script type="text/javascript">
        // Used in extra.js, we have to define the variable here since
        // we need access to the "config" jinja variable
        window.outsideDocs = [{"name": "cozy-app-publish", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/cozy-app-publish"}, {"name": "cozy-apps-registry", "repo": "https://github.com/cozy/cozy-apps-registry.git", "subdir": "."}, {"name": "cozy-client", "repo": "https://github.com/cozy/cozy-client.git", "subdir": "docs"}, {"name": "cozy-ui", "repo": "https://github.com/cozy/cozy-ui.git", "subdir": "docs"}, {"name": "cozy-doctypes", "repo": "https://github.com/cozy/cozy-doctypes.git", "subdir": "."}, {"name": "cozy-konnector-libs", "repo": "https://github.com/konnectors/libs.git", "subdir": "packages/cozy-konnector-libs/docs"}, {"name": "cozy-scripts", "repo": "https://github.com/cozy/create-cozy-app.git", "subdir": "packages/cozy-scripts/docs"}, {"name": "cozy-stack", "repo": "https://github.com/cozy/cozy-stack.git", "subdir": "docs"}, {"name": "babel-preset-cozy-app", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/babel-preset-cozy-app"}, {"name": "commitlint-config-cozy", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/commitlint-config-cozy"}, {"name": "cozy-device-helper", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/cozy-device-helper"}, {"name": "eslint-config-cozy-app", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/eslint-config-cozy-app"}, {"name": "cozy-notifications", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/cozy-notifications"}, {"name": "cozy-flags", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/cozy-flags"}, {"name": "cozy-realtime", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/cozy-realtime"}, {"name": "cozy-banks", "repo": "https://github.com/cozy/cozy-banks.git", "subdir": "."}, {"name": "cozy-home", "repo": "https://github.com/cozy/cozy-home.git", "subdir": "."}, {"name": "ach", "repo": "https://github.com/cozy/ach.git", "subdir": "."}, {"name": "cozy-coclyco", "repo": "https://github.com/cozy/cozy-coclyco.git", "subdir": "."}]
    </script>

    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700|Ubuntu+Mono&display=fallback">
        <style>body,input{font-family:"Lato","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../../css/extra.css">
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#install-cozy-on-ubuntu-2004-lts-focal-fossa" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.cozy.io/" title="Cozy Developer Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon">cloud</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Cozy Developer Documentation
            </span>
            <span class="md-header-nav__topic">
              
                on Ubuntu from sources (en)
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/cozy/cozy.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../../.." title="Home" class="md-tabs__link">
        Home
      </a>
    
  </li>

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../app/" title="Tutorials" class="md-tabs__link md-tabs__link--active">
          Tutorials
        </a>
      
    </li>
  

      
        
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../howTos/dev/runCozyDocker/" title="How-to" class="md-tabs__link">
          How-to
        </a>
      
    </li>
  

  

      
        
  
  
    
    
  
  
    
    
  
  
    <li class="md-tabs__item">
      
        <a href="../../../cozy-client/getting-started/" title="Libraries" class="md-tabs__link">
          Libraries
        </a>
      
    </li>
  

  

  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../../projects/" title="Projects" class="md-tabs__link">
          Projects
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.cozy.io/" title="Cozy Developer Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">cloud</i>
      
    </a>
    Cozy Developer Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/cozy/cozy.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../app/" title="Create Your Application" class="md-nav__link">
      Create Your Application
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-2" type="checkbox" id="nav-2-2">
    
    <label class="md-nav__link" for="nav-2-2">
      Develop a Connector
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-2">
        Develop a Connector
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../konnector/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../konnector/getting-started/" title="Basic structure" class="md-nav__link">
      Basic structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../konnector/scrape-data/" title="Scrape data" class="md-nav__link">
      Scrape data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../konnector/save-data/" title="Save data" class="md-nav__link">
      Save data
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../konnector/packaging/" title="Package your connector" class="md-nav__link">
      Package your connector
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-3" type="checkbox" id="nav-2-3">
    
    <label class="md-nav__link" for="nav-2-3">
      Manipulate data
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-3">
        Manipulate data
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/queries/" title="Queries" class="md-nav__link">
      Queries
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/pouchdb/" title="PouchDB" class="md-nav__link">
      PouchDB
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/doctypes/" title="DocTypes" class="md-nav__link">
      DocTypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/qualification/" title="Qualification" class="md-nav__link">
      Qualification
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../data/advanced/" title="Advanced" class="md-nav__link">
      Advanced
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-4" type="checkbox" id="nav-2-4" checked>
    
    <label class="md-nav__link" for="nav-2-4">
      Self-Hosting
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-2-4">
        Self-Hosting
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../selfhost-debian-pkg/" title="on Debian with packages" class="md-nav__link">
      on Debian with packages
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
    <a href="./" title="on Ubuntu from sources (en)" class="md-nav__link md-nav__link--active">
      on Ubuntu from sources (en)
    </a>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../selfhost-ubuntu-sources-fr/" title="on Ubuntu from sources (fr)" class="md-nav__link">
      on Ubuntu from sources (fr)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      How-to
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        How-to
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Dev
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Dev
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../howTos/dev/runCozyDocker/" title="Run an App in a Cozy using Docker" class="md-nav__link">
      Run an App in a Cozy using Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../howTos/dev/services/" title="Develop a service from your application" class="md-nav__link">
      Develop a service from your application
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../howTos/dev/hmr/" title="Use Hot Module Replacement in Your App" class="md-nav__link">
      Use Hot Module Replacement in Your App
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../howTos/dev/cordova/" title="Make a Mobile App Using Cordova" class="md-nav__link">
      Make a Mobile App Using Cordova
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../howTos/dev/connect-mobile-app-local-stack/" title="Connect a Mobile App to Your Local Stack" class="md-nav__link">
      Connect a Mobile App to Your Local Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../howTos/dev/run-connectors-on-local-cozy-stack/" title="Run Connectors With a Local cozy-stack" class="md-nav__link">
      Run Connectors With a Local cozy-stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../howTos/dev/sendmail/" title="Send and Receive E-mails in Development" class="md-nav__link">
      Send and Receive E-mails in Development
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../references/git-flow/" title="Our Front-End Git Flow" class="md-nav__link">
      Our Front-End Git Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../references/tech-intro/" title="Technical introduction to the Cozy platform" class="md-nav__link">
      Technical introduction to the Cozy platform
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Synchronize
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Synchronize
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../howTos/sync/linux/" title="Install Cozy Drive on GNU/Linux" class="md-nav__link">
      Install Cozy Drive on GNU/Linux
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Libraries
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Libraries
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1" type="checkbox" id="nav-4-1">
    
    <label class="md-nav__link" for="nav-4-1">
      Develop an application
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-1">
        Develop an application
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-1" type="checkbox" id="nav-4-1-1">
    
    <label class="md-nav__link" for="nav-4-1-1">
      Access data (client)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-1-1">
        Access data (client)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/getting-started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/relationships/" title="Using relationships" class="md-nav__link">
      Using relationships
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/timeseries/" title="Using time series" class="md-nav__link">
      Using time series
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/react-integration/" title="React integration" class="md-nav__link">
      React integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/hooks/" title="Hooks" class="md-nav__link">
      Hooks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/devtools/" title="Devtools" class="md-nav__link">
      Devtools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/metadata/" title="Metadata" class="md-nav__link">
      Metadata
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/logging/" title="Logging" class="md-nav__link">
      Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/node/" title="Node" class="md-nav__link">
      Node
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/architecture/" title="Architecture" class="md-nav__link">
      Architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/api/cozy-client/" title="Cozy Client API" class="md-nav__link">
      Cozy Client API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/api/cozy-pouch-link/" title="Cozy Pouch Link API" class="md-nav__link">
      Cozy Pouch Link API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-client/api/cozy-stack-client/" title="Cozy Stack Client API" class="md-nav__link">
      Cozy Stack Client API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-ui/" title="Build the user interface (ui)" class="md-nav__link">
      Build the user interface (ui)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-1-3" type="checkbox" id="nav-4-1-3">
    
    <label class="md-nav__link" for="nav-4-1-3">
      Define data (doctypes)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-1-3">
        Define data (doctypes)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/" title="README" class="md-nav__link">
      README
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.accounts/" title="Accounts" class="md-nav__link">
      Accounts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.apps/" title="Apps" class="md-nav__link">
      Apps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.apps.suggestions/" title="App suggestions" class="md-nav__link">
      App suggestions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.bank/" title="Banking doctypes" class="md-nav__link">
      Banking doctypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.bills/" title="Bills" class="md-nav__link">
      Bills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.konnectors/" title="Connectors" class="md-nav__link">
      Connectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.contacts/" title="Contacts" class="md-nav__link">
      Contacts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.docrules/" title="DocRules" class="md-nav__link">
      DocRules
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.files/" title="Files" class="md-nav__link">
      Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.files_metadata/" title="Files metadata" class="md-nav__link">
      Files metadata
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.home.settings/" title="Home settings" class="md-nav__link">
      Home settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.identities/" title="Identities" class="md-nav__link">
      Identities
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.notes/" title="Notes" class="md-nav__link">
      Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.notifications/" title="Notifications" class="md-nav__link">
      Notifications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.permissions/" title="Permissions" class="md-nav__link">
      Permissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.photos/" title="Photos" class="md-nav__link">
      Photos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.procedures/" title="Procedures" class="md-nav__link">
      Procedures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.sessions.logins/" title="Sessions Logins" class="md-nav__link">
      Sessions Logins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.settings/" title="Settings" class="md-nav__link">
      Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.sharings/" title="Sharings" class="md-nav__link">
      Sharings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.tags/" title="Tags" class="md-nav__link">
      Tags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.timeseries/" title="Time series" class="md-nav__link">
      Time series
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.todos/" title="Todos" class="md-nav__link">
      Todos
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.account_types/" title="Accounts Types" class="md-nav__link">
      Accounts Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/cc.cozycloud.autocategorization/" title="Autocategorization" class="md-nav__link">
      Autocategorization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.exports/" title="Exports" class="md-nav__link">
      Exports
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.jobs/" title="Jobs" class="md-nav__link">
      Jobs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.oauth.clients/" title="OAuth Clients" class="md-nav__link">
      OAuth Clients
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.oauth.access_codes/" title="OAuth Access Codes" class="md-nav__link">
      OAuth Access Codes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.triggers/" title="Triggers" class="md-nav__link">
      Triggers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.triggers.state/" title="Triggers state" class="md-nav__link">
      Triggers state
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.remote.requests/" title="Remote requests" class="md-nav__link">
      Remote requests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.sessions/" title="Sessions" class="md-nav__link">
      Sessions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.shared/" title="Shared" class="md-nav__link">
      Shared
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/io.cozy.terms/" title="Terms" class="md-nav__link">
      Terms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/com.bitwarden.ciphers/" title="Bitwarden ciphers" class="md-nav__link">
      Bitwarden ciphers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/com.bitwarden.folders/" title="Bitwarden folders" class="md-nav__link">
      Bitwarden folders
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/com.bitwarden.organizations/" title="Bitwarden organizations" class="md-nav__link">
      Bitwarden organizations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/com.bitwarden.contacts/" title="Bitwarden contacts" class="md-nav__link">
      Bitwarden contacts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-doctypes/docs/com.unibet.bets/" title="Bets Unibet" class="md-nav__link">
      Bets Unibet
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-realtime/" title="Realtime data (realtime)" class="md-nav__link">
      Realtime data (realtime)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-device-helper/" title="Native devices (device-helper)" class="md-nav__link">
      Native devices (device-helper)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-2" type="checkbox" id="nav-4-2">
    
    <label class="md-nav__link" for="nav-4-2">
      Develop a konnector
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-2">
        Develop a konnector
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-konnector-libs/" title="README" class="md-nav__link">
      README
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-konnector-libs/api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-konnector-libs/cli/" title="CLI" class="md-nav__link">
      CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-konnector-libs/dev/" title="Develop" class="md-nav__link">
      Develop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-konnector-libs/errors/" title="Errors" class="md-nav__link">
      Errors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-konnector-libs/operation-linking/" title="Operation linking" class="md-nav__link">
      Operation linking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-konnector-libs/synchronization/" title="Synchronization" class="md-nav__link">
      Synchronization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-app-publish/" title="Publish on the store (app-publish)" class="md-nav__link">
      Publish on the store (app-publish)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-notifications/" title="Send notifications (cozy-notifications)" class="md-nav__link">
      Send notifications (cozy-notifications)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-5" type="checkbox" id="nav-4-5">
    
    <label class="md-nav__link" for="nav-4-5">
      Dev tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-5">
        Dev tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../babel-preset-cozy-app/" title="Babel preset" class="md-nav__link">
      Babel preset
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../commitlint-config-cozy/" title="Commitlint" class="md-nav__link">
      Commitlint
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../eslint-config-cozy-app/" title="ESLint" class="md-nav__link">
      ESLint
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../ach/" title="ACH" class="md-nav__link">
      ACH
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6" type="checkbox" id="nav-4-6">
    
    <label class="md-nav__link" for="nav-4-6">
      Advanced
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-6">
        Advanced
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6-1" type="checkbox" id="nav-4-6-1">
    
    <label class="md-nav__link" for="nav-4-6-1">
      Stack server
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-6-1">
        Stack server
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/" title="README" class="md-nav__link">
      README
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6-1-2" type="checkbox" id="nav-4-6-1-2">
    
    <label class="md-nav__link" for="nav-4-6-1-2">
      Usage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-6-1-2">
        Usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/INSTALL/" title="Install the cozy-stack" class="md-nav__link">
      Install the cozy-stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/config/" title="Configuration file" class="md-nav__link">
      Configuration file
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/instance/" title="Managing Instances" class="md-nav__link">
      Managing Instances
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/security/" title="Security" class="md-nav__link">
      Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/cli/cozy-stack/" title="Manpages of the command-line tool" class="md-nav__link">
      Manpages of the command-line tool
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/admin/" title="Using the admin API" class="md-nav__link">
      Using the admin API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/important-changes/" title="Important changes" class="md-nav__link">
      Important changes
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6-1-3" type="checkbox" id="nav-4-6-1-3">
    
    <label class="md-nav__link" for="nav-4-6-1-3">
      How-to guides for developpers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-6-1-3">
        How-to guides for developpers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/http-api/" title="Using the HTTP API" class="md-nav__link">
      Using the HTTP API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/client-app-dev/" title="Develop a client-side app" class="md-nav__link">
      Develop a client-side app
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/docker/" title="Running and building Docker images" class="md-nav__link">
      Running and building Docker images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/doctype/" title="Adding a new doctype" class="md-nav__link">
      Adding a new doctype
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/assets/" title="Working with the stack assets" class="md-nav__link">
      Working with the stack assets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/release/" title="Build a release" class="md-nav__link">
      Build a release
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/CONTRIBUTING/" title="The contributing guide" class="md-nav__link">
      The contributing guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6-1-4" type="checkbox" id="nav-4-6-1-4">
    
    <label class="md-nav__link" for="nav-4-6-1-4">
      Explanations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-6-1-4">
        Explanations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/flagship/" title="Flagship app" class="md-nav__link">
      Flagship app
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/move-design/" title="Move design" class="md-nav__link">
      Move design
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/realtime-internals/" title="Realtime internals" class="md-nav__link">
      Realtime internals
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/sharing-design/" title="Sharing design" class="md-nav__link">
      Sharing design
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/konnectors-workflow/" title="Workflow of the konnectors" class="md-nav__link">
      Workflow of the konnectors
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-6-1-5" type="checkbox" id="nav-4-6-1-5">
    
    <label class="md-nav__link" for="nav-4-6-1-5">
      List of services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-4-6-1-5">
        List of services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/auth/" title="/auth - Authentication & OAuth" class="md-nav__link">
      /auth - Authentication & OAuth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/delegated-auth/" title="/oidc - Delegated authentication" class="md-nav__link">
       /oidc - Delegated authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/apps/" title="/apps - Applications Management" class="md-nav__link">
      /apps - Applications Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/registry/" title="/apps - Apps registry" class="md-nav__link">
       /apps - Apps registry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/bitwarden/" title="/bitwarden - Bitwarden" class="md-nav__link">
      /bitwarden - Bitwarden
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/connection-check/" title="/connection_check - Connection check" class="md-nav__link">
      /connection_check - Connection check
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/contacts/" title="/contacts - Contacts" class="md-nav__link">
      /contacts - Contacts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/data-system/" title="/data - Data System" class="md-nav__link">
      /data - Data System
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/mango/" title="/data - Mango" class="md-nav__link">
       /data - Mango
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/couchdb-quirks/" title="/data - CouchDB Quirks" class="md-nav__link">
       /data - CouchDB Quirks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/pouchdb-quirks/" title="/data - PouchDB Quirks" class="md-nav__link">
       /data - PouchDB Quirks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/files/" title="/files - Virtual File System" class="md-nav__link">
      /files - Virtual File System
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/not-synchronized-vfs/" title="/files - Not synchronized directories" class="md-nav__link">
       /files - Not synchronized directories
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/references-docs-in-vfs/" title="/files - References of documents in VFS" class="md-nav__link">
       /files - References of documents in VFS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/intents/" title="/intents - Intents" class="md-nav__link">
      /intents - Intents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/jobs/" title="/jobs - Jobs" class="md-nav__link">
      /jobs - Jobs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/workers/" title="/jobs - Workers" class="md-nav__link">
       /jobs - Workers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/konnectors/" title="/konnectors - Konnectors" class="md-nav__link">
      /konnectors - Konnectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/move/" title="/move - Move, export and import an instance" class="md-nav__link">
      /move - Move, export and import an instance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/notes/" title="/notes - Notes for collaborative edition" class="md-nav__link">
      /notes - Notes for collaborative edition
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/notifications/" title="/notifications - Notifications" class="md-nav__link">
      /notifications - Notifications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/office/" title="/office - Collaborative edition of Office documents" class="md-nav__link">
      /office - Collaborative edition of Office documents
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/public/" title="/public - Public" class="md-nav__link">
      /public - Public
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/permissions/" title="/permissions - Permissions" class="md-nav__link">
      /permissions - Permissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/realtime/" title="/realtime - Realtime" class="md-nav__link">
      /realtime - Realtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/remote/" title="/remote - Proxy for remote data/API" class="md-nav__link">
      /remote - Proxy for remote data/API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/settings/" title="/settings - Settings" class="md-nav__link">
      /settings - Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/user-action-required/" title="/settings - Terms of Services" class="md-nav__link">
       /settings - Terms of Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/sharing/" title="/sharings - Sharing" class="md-nav__link">
      /sharings - Sharing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/shortcuts/" title="/shortcuts - Shortcuts" class="md-nav__link">
      /shortcuts - Shortcuts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-stack/wellknown/" title="/.well-known - Well-known" class="md-nav__link">
      /.well-known - Well-known
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../../cozy-apps-registry/" title="Registry server" class="md-nav__link">
      Registry server
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Projects
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Projects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../../projects/" title="Documentations" class="md-nav__link">
      Documentations
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/cozy/cozy.github.io/edit/dev/src/tutorials/selfhosting/selfhost-ubuntu-sources-en.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="install-cozy-on-ubuntu-2004-lts-focal-fossa">Install Cozy on Ubuntu 20.04 LTS focal fossa<a class="headerlink" href="#install-cozy-on-ubuntu-2004-lts-focal-fossa" title="Permanent link">&para;</a></h1>
<h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h1>
<p>Cozycloud provides Debian packages and <a href="https://docs.cozy.io/en/tutorials/selfhosting/selfhost-debian-pkg/">installation instructions</a> for Debian 10 buster from installation packages. However, there is no published packages for Ubuntu.</p>
<p>This documentation describes how to install Cozy from sources on an Ubuntu 20.04 LTS focal fossa server. We will also see how to host multiple Cozy instances on the same server, how to activate online edition for office documents and how to upgrade cozy-stack.</p>
<h1 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h1>
<p>The installation procedure requires:</p>
<ul>
<li>An Ubuntu 20.04 LTS focal fossa server</li>
<li>A domain name (mandatory to host Cozy instances secured with https and accessible from internet).
    In this docuemnt, we will use <code>domain.example</code> as an example. You will replace it with your own domain name throughout the explanation.
    The address of your Cozy instance will be <code>cozy.domain.example</code></li>
<li>Good system administration knowledge. Despite documentation&rsquo;s goal is to be pretty straightforward to follow, there are some tricky and technical parts.</li>
</ul>
<p>During installation, you will also define:</p>
<ul>
<li>a CouchDB administration password</li>
<li>a CouchDB database access password</li>
<li>a cozy-stack admin password</li>
<li>You will need to provide your email address for Let&rsquo;s Encrypt SSL certificate validation and your Cozy instance creation</li>
</ul>
<h1 id="couchdb">Couchdb<a class="headerlink" href="#couchdb" title="Permanent link">&para;</a></h1>
<p>Configure CouchDB package repository:</p>
<div class="codehilite"><pre><span></span>sudo apt update &amp;&amp; sudo apt install -y curl apt-transport-https gnupg
curl https://couchdb.apache.org/repo/keys.asc | gpg --dearmor | sudo tee /usr/share/keyrings/couchdb-archive-keyring.gpg &gt;/dev/null 2&gt;&amp;1
echo &quot;deb [signed-by=/usr/share/keyrings/couchdb-archive-keyring.gpg] https://apache.jfrog.io/artifactory/couchdb-deb/ $(lsb_release -sc) main&quot; | sudo tee /etc/apt/sources.list.d/couchdb.list &gt;/dev/null
</pre></div>


<p>Install Couchdb:</p>
<div class="codehilite"><pre><span></span>sudo apt update
sudo apt install -y couchdb
</pre></div>


<p>Duing CouchDB installation, choose <code>Standalone</code> mode and define admin password.</p>
<p>Validate CouchDB is working:</p>
<div class="codehilite"><pre><span></span>curl http://localhost:5984/
{&quot;couchdb&quot;:&quot;Welcome&quot;,&quot;version&quot;:&quot;3.2.1&quot;,&quot;git_sha&quot;:&quot;244d428af&quot;,&quot;uuid&quot;:&quot;f7b83554fa2eb43778963d18a1f92211&quot;,&quot;features&quot;:[&quot;access-ready&quot;,&quot;partitioned&quot;,&quot;pluggable-storage-engines&quot;,&quot;reshard&quot;,&quot;scheduler&quot;],&quot;vendor&quot;:{&quot;name&quot;:&quot;The Apache Software Foundation&quot;}}
</pre></div>


<p>Finally, create a database user and password for  cozy-stack:</p>
<div class="codehilite"><pre><span></span><span class="n">read</span> <span class="o">-</span><span class="n">p</span> <span class="s">&quot;Couchdb password for cozy user: &quot;</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="n">s</span> <span class="n">COUCH_PASS</span>
<span class="n">curl</span> <span class="o">-</span><span class="n">fsX</span> <span class="n">PUT</span> <span class="o">-</span><span class="n">u</span> <span class="s">&quot;admin:adminpwd&quot;</span> <span class="s">&quot;http://localhost:5984/_node/couchdb@127.0.0.1/_config/admins/cozy&quot;</span> <span class="o">--</span><span class="n">data</span> <span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">${COUCH_PASS}</span><span class="se">\&quot;</span><span class="s">&quot;</span>
</pre></div>


<p>In this command line, <code>adminpwd</code> should be replaced by CouchDB admin password you defined during CouchDB installation.</p>
<h1 id="nodejs">NodeJS<a class="headerlink" href="#nodejs" title="Permanent link">&para;</a></h1>
<p>To be able to run Cozy connectors and gather all your data, cozy-stack needs NodeJS version 12 or 16. This documents gives instructions to instal NodeJS 16.</p>
<p>Configure NodeJS 16 package repository:</p>
<div class="codehilite"><pre><span></span>KEYRING=/usr/share/keyrings/nodesource.gpg
curl -fsSL https://deb.nodesource.com/gpgkey/nodesource.gpg.key | gpg --dearmor | sudo tee &quot;$KEYRING&quot; &gt;/dev/null
echo &quot;deb [signed-by=$KEYRING] https://deb.nodesource.com/node_16.x $(lsb_release -sc) main&quot; | sudo tee /etc/apt/sources.list.d/nodesource.list &gt;/dev/null
echo &quot;deb-src [signed-by=$KEYRING] https://deb.nodesource.com/node_16.x $(lsb_release -sc) main&quot; | sudo tee -a /etc/apt/sources.list.d/nodesource.list &gt;/dev/null
</pre></div>


<p>Install NodeJS:</p>
<div class="codehilite"><pre><span></span>sudo apt update
sudo apt install -y nodejs
sudo ln -s /usr/bin/node /usr/bin/nodejs
</pre></div>


<h1 id="go">Go<a class="headerlink" href="#go" title="Permanent link">&para;</a></h1>
<p>cozy-stack is developped in Go language so we need to install the Go compiler to be able to compile cozy-stack sources:</p>
<div class="codehilite"><pre><span></span>wget -O /tmp/go1.17.3.linux-amd64.tar.gz https://go.dev/dl/go1.17.3.linux-amd64.tar.gz
sudo rm -rf /usr/local/go &amp;&amp; sudo tar -C /usr/local -xzvf /tmp/go1.17.3.linux-amd64.tar.gz
echo &quot;export PATH=\&quot;\$PATH:/usr/local/go/bin\&quot;&quot; | sudo tee /etc/profile.d/golang.sh &gt; /dev/null
source /etc/profile.d/golang.sh
</pre></div>


<p>Test Go installation is fine with:</p>
<div class="codehilite"><pre><span></span>go version
go version go1.17.3 linux/amd64
</pre></div>


<h1 id="cozy-stack">Cozy-stack<a class="headerlink" href="#cozy-stack" title="Permanent link">&para;</a></h1>
<p>First, install requirements:</p>
<div class="codehilite"><pre><span></span>sudo apt install -y imagemagick libprotobuf-c1 fonts-lato
</pre></div>


<p>Get the source code:</p>
<div class="codehilite"><pre><span></span>sudo apt install -y git
sudo git clone https://github.com/cozy/cozy-stack.git /opt/cozy-stack
</pre></div>


<p>Then compile the program:</p>
<div class="codehilite"><pre><span></span>cd /opt/cozy-stack
scripts/build.sh release $(go env GOPATH)/bin/cozy-stack
</pre></div>


<p>The compilation generate a binary file under <code>$GOPATH/bin/cozy-stack</code></p>
<p>You can test it with:</p>
<div class="codehilite"><pre><span></span>$(go env GOPATH)/bin/cozy-stack version
1.5.0-5-gcbdf012d
</pre></div>


<p>You then have to create a user to run cozy-stack:</p>
<div class="codehilite"><pre><span></span>sudo addgroup --quiet --system cozy
sudo adduser --quiet --system --home /var/lib/cozy \
             --no-create-home --shell /usr/sbin/nologin \
             --ingroup cozy cozy-stack
</pre></div>


<p>And install it:</p>
<div class="codehilite"><pre><span></span>sudo install -o root -g root -m 0755 -T \
             $(go env GOPATH)/bin/cozy-stack /usr/bin/cozy-stack
sudo sh -c &#39;cozy-stack completion bash &gt; /etc/bash_completion.d/cozy-stack&#39;
source /etc/bash_completion.d/cozy-stack
sudo install -o root -g root -m 0755 -d /etc/cozy
sudo install -o root -g cozy -m 0750 -d /var/log/cozy
sudo install -o cozy-stack -g cozy -m 750 -d /usr/share/cozy
sudo install -o cozy-stack -g cozy -m 750 \
             /opt/cozy-stack/scripts/konnector-node16-run.sh \
             /usr/share/cozy/konnector-node16-run.sh
sudo install -o cozy-stack -g cozy -m 750 -d /var/lib/cozy
</pre></div>


<p>And create configuration:</p>
<div class="codehilite"><pre><span></span><span class="n">read</span> <span class="o">-</span><span class="n">p</span> <span class="s">&quot;Cozy stack admin password: &quot;</span> <span class="o">-</span><span class="n">r</span> <span class="o">-</span><span class="n">s</span> <span class="n">COZY_PASS</span>
<span class="n">cat</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span> <span class="o">|</span> <span class="n">sudo</span> <span class="n">tee</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">cozy</span><span class="p">.</span><span class="n">yml</span> <span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
<span class="nl">host</span><span class="p">:</span> <span class="mf">127.0.0.1</span>
<span class="nl">port</span><span class="p">:</span> <span class="mi">8080</span>

<span class="nl">admin</span><span class="p">:</span>
  <span class="nl">host</span><span class="p">:</span> <span class="mf">127.0.0.1</span>
  <span class="nl">port</span><span class="p">:</span> <span class="mi">6060</span>

<span class="nl">couchdb</span><span class="p">:</span>
  <span class="nl">url</span><span class="p">:</span> <span class="nl">http</span><span class="p">:</span><span class="c1">//cozy:${COUCH_PASS}@127.0.0.1:5984/</span>

<span class="nl">fs</span><span class="p">:</span>
  <span class="nl">url</span><span class="p">:</span> <span class="nl">file</span><span class="p">:</span><span class="c1">///var/lib/cozy</span>

<span class="nl">vault</span><span class="p">:</span>
  <span class="nl">credentials_encryptor_key</span><span class="p">:</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">vault</span><span class="p">.</span><span class="n">enc</span>
  <span class="nl">credentials_decryptor_key</span><span class="p">:</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">vault</span><span class="p">.</span><span class="n">dec</span>

<span class="nl">konnectors</span><span class="p">:</span>
  <span class="nl">cmd</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">konnector</span><span class="o">-</span><span class="n">node16</span><span class="o">-</span><span class="n">run</span><span class="p">.</span><span class="n">sh</span>

<span class="nl">log</span><span class="p">:</span>
  <span class="nl">level</span><span class="p">:</span> <span class="n">info</span>
  <span class="nl">syslog</span><span class="p">:</span> <span class="nb">true</span>

<span class="nl">registries</span><span class="p">:</span>
  <span class="k">default</span><span class="o">:</span>
  <span class="o">-</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//apps-registry.cozycloud.cc/selfhosted</span>
  <span class="o">-</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//apps-registry.cozycloud.cc/banks</span>
  <span class="o">-</span> <span class="nl">https</span><span class="p">:</span><span class="c1">//apps-registry.cozycloud.cc/</span>
<span class="n">EOF</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="n">cozy</span><span class="o">-</span><span class="nl">stack</span><span class="p">:</span><span class="n">cozy</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">cozy</span><span class="p">.</span><span class="n">yml</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="mo">0644</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">cozy</span><span class="p">.</span><span class="n">yml</span>
<span class="n">sudo</span> <span class="n">sh</span> <span class="o">-</span><span class="n">c</span> <span class="s">&quot;COZY_ADMIN_PASSPHRASE=</span><span class="se">\&quot;</span><span class="s">${COZY_PASS}</span><span class="se">\&quot;</span><span class="s"> cozy-stack config passwd /etc/cozy/cozy-admin-passphrase&quot;</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="n">cozy</span><span class="o">-</span><span class="nl">stack</span><span class="p">:</span><span class="n">cozy</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">cozy</span><span class="o">-</span><span class="n">admin</span><span class="o">-</span><span class="n">passphrase</span>
<span class="n">sudo</span> <span class="n">cozy</span><span class="o">-</span><span class="n">stack</span> <span class="n">config</span> <span class="n">gen</span><span class="o">-</span><span class="n">keys</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">vault</span>
<span class="n">sudo</span> <span class="n">chown</span> <span class="n">cozy</span><span class="o">-</span><span class="nl">stack</span><span class="p">:</span><span class="n">cozy</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">vault</span><span class="p">.</span><span class="n">enc</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">vault</span><span class="p">.</span><span class="n">dec</span>
<span class="n">sudo</span> <span class="n">chmod</span> <span class="mo">0600</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">vault</span><span class="p">.</span><span class="n">enc</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cozy</span><span class="o">/</span><span class="n">vault</span><span class="p">.</span><span class="n">dec</span>
</pre></div>


<p>Finally, configure systemd to automatically launch cozy-stack on boot:</p>
<div class="codehilite"><pre><span></span>cat &lt;&lt;EOF | sudo tee /usr/lib/systemd/system/cozy-stack.service &gt;/dev/null
[Unit]
Description=Cozy service
Wants=couchdb.service
After=network.target couchdb.service

[Service]
User=cozy-stack
Group=cozy
WorkingDirectory=/var/lib/cozy/
PermissionsStartOnly=true
ExecStart=/usr/bin/cozy-stack serve
Restart=always

[Install]
WantedBy=multi-user.target
EOF
sudo systemctl daemon-reload
sudo systemctl enable cozy-stack
sudo systemctl start cozy-stack
</pre></div>


<p>You can validate everything went well and cozy-stack is running thiw way:</p>
<div class="codehilite"><pre><span></span>curl http://localhost:8080/version
{&quot;build_mode&quot;:&quot;production&quot;,&quot;build_time&quot;:&quot;2021-12-01T13:12:36Z&quot;,&quot;runtime_version&quot;:&quot;go1.17.3&quot;,&quot;version&quot;:&quot;1.5.0-5-gcbdf012d&quot;}
</pre></div>


<h1 id="nginx">Nginx<a class="headerlink" href="#nginx" title="Permanent link">&para;</a></h1>
<p>First create a DNS entry in your domain for <code>cozy.domain.example</code> and <code>*.cozy.domain.example</code> pointing at your server. For example:</p>
<div class="codehilite"><pre><span></span>cozy     1h     IN         A     &lt;your_server_IP&gt;
*.cozy   1h     IN     CNAME     cozy
</pre></div>


<p>Then install Nginx:</p>
<div class="codehilite"><pre><span></span>sudo apt install -y nginx certbot
</pre></div>


<p>Generate SSL certificate with certbot:</p>
<div class="codehilite"><pre><span></span>DOMAIN=domain.example
EMAIL=&quot;<span class="nt">&lt;your</span> <span class="err">email</span> <span class="err">address</span><span class="nt">&gt;</span>&quot;
sudo certbot certonly --email &quot;<span class="cp">${</span><span class="n">EMAIL</span><span class="cp">}</span>&quot; --non-interactive --agree-tos --webroot -w /var/www/html -d cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span> $(printf -- &quot; -d %s.cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>&quot; home banks contacts drive notes passwords photos settings store)
</pre></div>


<p>Create nginx reload script for your certificate to be reloaded each time it is automatically refreshed, every 3 months:</p>
<div class="codehilite"><pre><span></span>cat &lt;&lt;EOF | sudo tee /etc/letsencrypt/renewal-hooks/deploy/reload-nginx.sh
#!/bin/bash
nginx -t -q &amp;&amp; nginx -s reload
EOF
chmod 0755 /etc/letsencrypt/renewal-hooks/deploy/reload-nginx.sh
</pre></div>


<p>Configure nginx:</p>
<div class="codehilite"><pre><span></span>DOMAIN=domain.example
cat <span class="err">&lt;</span><span class="nt">&lt;EOF</span> <span class="err">|</span> <span class="err">sudo</span> <span class="err">tee</span> <span class="err">/etc/nginx/sites-available/cozy.${DOMAIN}</span> <span class="nt">&gt;</span> /dev/null
server {
    listen 80;
    listen [::]:80;

    root /var/www/html;
    server_name *.cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span> cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>;

    location /.well-known {
        alias /var/www/html/.well-known;
    }

    location / {
        return         301 https://\<span class="nv">$host</span>\<span class="nv">$request_uri</span>;
    }
}

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    ssl_certificate /etc/letsencrypt/live/cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>/privkey.pem;

    server_name *.cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span> cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>;
    access_log /var/log/nginx/cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>.access.log;
    error_log /var/log/nginx/cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>.error.log;

    add_header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains;&quot;;
    client_max_body_size 1g;

    location / {
        proxy_pass http://localhost:8080;
        proxy_http_version 1.1;
        proxy_set_header Upgrade \<span class="nv">$http_upgrade</span>;
        proxy_set_header Connection &quot;upgrade&quot;;
        proxy_set_header Host \<span class="nv">$host</span>;
        proxy_set_header X-Forwarded-For \<span class="nv">$remote_addr</span>;
    }
}
EOF
sudo ln -s ../sites-available/cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span> /etc/nginx/sites-enabled/
sudo systemctl reload nginx
</pre></div>


<p>You can then test from your browser by visiting <code>https://cozy.domain.example</code> and you should see a page telling you this Cozy instance doesn&rsquo;t exist yet. This is the sign that everything went well and the only part left is to create the instance.</p>
<h1 id="cozy-instance-creation">Cozy instance creation<a class="headerlink" href="#cozy-instance-creation" title="Permanent link">&para;</a></h1>
<p>Create your Cozy instance:</p>
<div class="codehilite"><pre><span></span>DOMAIN=domain.example
EMAIL=<span class="nt">&lt;your</span> <span class="err">email</span> <span class="err">address</span><span class="nt">&gt;</span>
[[ -z &quot;<span class="cp">${</span><span class="n">COZY_PASS</span><span class="cp">}</span>&quot; ]] <span class="err">&amp;&amp;</span> read -p &quot;Cozy stack admin password: &quot; -r -s COZY_PASS
COZY_ADMIN_PASSWORD=&quot;<span class="cp">${</span><span class="n">COZY_PASS</span><span class="cp">}</span>&quot; cozy-stack instances add --apps home,banks,contacts,drive,notes,passwords,photos,settings,store --email &quot;<span class="cp">${</span><span class="n">EMAIL</span><span class="cp">}</span>&quot; --locale fr --tz &quot;Europe/Paris&quot; cozy.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>
</pre></div>


<p>You can of course adapt your language (<code>locale</code>) and choose english (<code>en</code>) or spanish (<code>es</code>) and choose another timezone (<code>tz</code>).</p>
<p>Note the “Registration token” this command returns and visit from your browser <code>https://cozy.domain.example?registerToken=&lt;registration_token&gt;</code> substituting <code>domain.example</code> with your real domain name and <code>&lt;registration_token&gt;</code> with the “Registration token” you got.
You will be prompted to define your Cozy password and you will be able to start using your self-hosted Cozy.</p>
<h1 id="et-voila">Et voilà !<a class="headerlink" href="#et-voila" title="Permanent link">&para;</a></h1>
<p>Your Cozy is not fully operational! Its address is <code>https://cozy.domain.example</code> (remplace <code>domain.example</code> by your own domain name)
You can then start installing connectors from store to automatically gather your data, save your passwords in cozy-pass, store your files in cozy-drive and install cozy-desktop client on your PC to synchronize your Cozy content with a local folder.</p>
<p>Below are some bonuses 😉</p>
<h1 id="hosting-more-than-one-cozy-instance-on-the-same-server">Hosting more than one Cozy instance on the same server<a class="headerlink" href="#hosting-more-than-one-cozy-instance-on-the-same-server" title="Permanent link">&para;</a></h1>
<p>Having its own selfhosted Cozy instance is nice but hosting Cozy instances for friends and family is a must! Here is how to add more Cozy instances on the same server.</p>
<p>The first Cozy instance we added was <code>https://cozy.domain.example</code>. We will create a second Cozy instance for Mary with address <code>https://mary.domain.example</code> (Replace <code>domain.example</code> with your own domain name and <code>mary</code> with what you want to uniquely identify the Cozy instance.</p>
<p>So we will need:</p>
<ul>
<li>Our domain name. We still use <code>domain.example</code> in this documentation</li>
<li>The new Cozy instance&rsquo;s “slug”, which is its unique identifier. We will use <code>mary</code> here for example. The address for this new Cozy instance will the be in the form <code>https://&lt;slug&gt;.&lt;domain&gt;</code>, for example here <code>https://mary.domain.example</code></li>
</ul>
<p>First, let&rsquo;s put all that important information in variables:</p>
<div class="codehilite"><pre><span></span>DOMAIN=domain.example
EMAIL=&lt;your email addresse&gt;
NEWSLUG=mary
NEWEMAIL=&lt;Mary&#39;s email address&gt;
</pre></div>


<p>Create DNS entries for this Cozy instance. For example:</p>
<div class="codehilite"><pre><span></span>mary     1h     IN         A     &lt;your_server_IP&gt;
*.mary   1h     IN     CNAME     mary
</pre></div>


<p>Create Nginx base configuration for this Cozy instance:</p>
<div class="codehilite"><pre><span></span>cat <span class="err">&lt;</span><span class="nt">&lt;EOF</span> <span class="err">|</span> <span class="err">sudo</span> <span class="err">tee</span> <span class="err">/etc/nginx/sites-available/${NEWSLUG}.${DOMAIN}</span> <span class="nt">&gt;</span> /dev/null
server {
    listen 80;
    listen [::]:80;

    root /var/www/html;
    server_name *.<span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span> <span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>;

    location /.well-known {
        alias /var/www/html/.well-known;
    }

    location / {
        return         301 https://\<span class="nv">$host</span>\<span class="nv">$request_uri</span>;
    }
}
EOF
sudo ln -s ../sites-available/<span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span> /etc/nginx/sites-enabled/
sudo systemctl reload nginx
</pre></div>


<p>Generate SSL certificate using certbot:</p>
<div class="codehilite"><pre><span></span>sudo certbot certonly --email &quot;<span class="cp">${</span><span class="n">EMAIL</span><span class="cp">}</span>&quot; --non-interactive --agree-tos --webroot -w /var/www/html -d <span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span> $(printf -- &quot; -d %s.<span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>&quot; home banks contacts drive notes passwords photos settings store)
</pre></div>


<p>Finalize Nginx configuration:</p>
<div class="codehilite"><pre><span></span>cat <span class="err">&lt;</span><span class="nt">&lt;EOF</span> <span class="err">|</span> <span class="err">sudo</span> <span class="err">tee</span> <span class="err">-a</span> <span class="err">/etc/nginx/sites-available/${NEWSLUG}.${DOMAIN}</span> <span class="nt">&gt;</span> /dev/null

server {
    listen 443 ssl http2;
    listen [::]:443 ssl http2;
    ssl_certificate /etc/letsencrypt/live/<span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/<span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>/privkey.pem;

    server_name *.<span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span> <span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>;
    access_log /var/log/nginx/<span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>.access.log;
    error_log /var/log/nginx/<span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>.error.log;

    add_header Strict-Transport-Security &quot;max-age=31536000; includeSubDomains;&quot;;
    client_max_body_size 1g;

    location / {
        proxy_pass http://localhost:8080;
        proxy_http_version 1.1;
        proxy_set_header Upgrade \<span class="nv">$http_upgrade</span>;
        proxy_set_header Connection &quot;upgrade&quot;;
        proxy_set_header Host \<span class="nv">$host</span>;
        proxy_set_header X-Forwarded-For \<span class="nv">$remote_addr</span>;
    }
}
EOF
sudo systemctl reload nginx
</pre></div>


<p>Create Cozy instance:</p>
<div class="codehilite"><pre><span></span>[[ -z &quot;<span class="cp">${</span><span class="n">COZY_PASS</span><span class="cp">}</span>&quot; ]] <span class="err">&amp;&amp;</span> read -p &quot;Cozy stack admin password: &quot; -r -s COZY_PASS
COZY_ADMIN_PASSWORD=&quot;<span class="cp">${</span><span class="n">COZY_PASS</span><span class="cp">}</span>&quot; cozy-stack instances add --apps home,banks,contacts,drive,notes,passwords,photos,settings,store --email &quot;<span class="cp">${</span><span class="n">NEWEMAIL</span><span class="cp">}</span>&quot; --locale fr --tz &quot;Europe/Paris&quot; <span class="cp">${</span><span class="n">NEWSLUG</span><span class="cp">}</span>.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>
</pre></div>


<p>Note the “Registration token” the last command gives you and send Mary the following url: <code>https://mary.domain.example?registerToken=&lt;registration_token&gt;</code>, substituting <code>domain.example</code> with your own domain name, <code>mary</code> with the slug you chose for this new instance and  <code>&lt;registration_token&gt;</code> with the “Registration token” returned by the last command.
By visiting this address with her browser, Mary will be able to define its password and start using her Cozy.</p>
<h1 id="online-edition-of-office-documents">Online edition of office documents<a class="headerlink" href="#online-edition-of-office-documents" title="Permanent link">&para;</a></h1>
<p>Online office document edition functionality based on OnlyOffice is optional. You can use your Cozy without activating it. It let you edit your office documents online directly in your browser, however it requires more resources on your server.</p>
<p>To activate this functionality, you need to install OnlyOffice document server and configure cozy-stack to access it. OnlyOffice document server can be installed on the same server or on another server at your convenience. This documentation explain how to install it on the same server.</p>
<h2 id="onlyoffice">Onlyoffice<a class="headerlink" href="#onlyoffice" title="Permanent link">&para;</a></h2>
<p>Onlyoffice requires PostgreSQL and RabbitMQ so we will start by installing them.</p>
<h3 id="install-postgresql-and-create-database">Install PostgreSQL and create database<a class="headerlink" href="#install-postgresql-and-create-database" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>sudo apt update
sudo -i -u postgres psql -c &quot;CREATE DATABASE onlyoffice;&quot;
sudo -i -u postgres psql -c &quot;CREATE USER onlyoffice WITH password &#39;onlyoffice&#39;;&quot;
sudo -i -u postgres psql -c &quot;GRANT ALL privileges ON DATABASE onlyoffice TO onlyoffice;
</pre></div>


<p>The second command create a database user names <code>onlyoffice</code> with password <code>onlyoffice</code>. We advise you to choose a more secure password in real life.</p>
<h3 id="install-rabbitmq">Install RabbitMQ<a class="headerlink" href="#install-rabbitmq" title="Permanent link">&para;</a></h3>
<div class="codehilite"><pre><span></span>sudo apt install -y rabbitmq-server
</pre></div>


<h3 id="install-onlyoffice-documentserver">Install Onlyoffice Documentserver<a class="headerlink" href="#install-onlyoffice-documentserver" title="Permanent link">&para;</a></h3>
<p>Configure package repository</p>
<div class="codehilite"><pre><span></span>sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys CB2DE8E5
echo &quot;deb https://download.onlyoffice.com/repo/debian squeeze main&quot; | sudo tee /etc/apt/sources.list.d/onlyoffice.list
sudo apt update
</pre></div>


<p>Install microsoft fonts</p>
<div class="codehilite"><pre><span></span>sudo apt install -y ttf-mscorefonts-installer
</pre></div>


<p>When asked, accept EULA</p>
<p>Install OnlyOffice Documentserver</p>
<div class="codehilite"><pre><span></span>sudo apt install -y onlyoffice-documentserver
</pre></div>


<p>When asked, enter database password we created when installing postgreSQL and created database.</p>
<p>Then restart Nginx</p>
<div class="codehilite"><pre><span></span>sudo systemctl reload nginx
</pre></div>


<h3 id="configure-https-for-onlyoffice">Configure HTTPS for OnlyOffice<a class="headerlink" href="#configure-https-for-onlyoffice" title="Permanent link">&para;</a></h3>
<p>Create a DNS entry for OnlyOffice targeting your server. For example:</p>
<div class="codehilite"><pre><span></span>onlyoffice     1h     IN         A     &lt;your_server_IP&gt;
</pre></div>


<p>Generate SSL certificate:</p>
<div class="codehilite"><pre><span></span>EMAIL=<span class="nt">&lt;your</span> <span class="err">email</span> <span class="err">address</span><span class="nt">&gt;</span>
DOMAIN=domain.example
sudo bash /usr/bin/documentserver-letsencrypt.sh &quot;<span class="cp">${</span><span class="n">EMAIL</span><span class="cp">}</span>&quot; &quot;onlyoffice.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>&quot;
</pre></div>


<p>Configure onlyoffice:</p>
<div class="codehilite"><pre><span></span>sudo cp -f /etc/onlyoffice/documentserver/nginx/ds-ssl.conf.tmpl /etc/onlyoffice/documentserver/nginx/ds.conf
</pre></div>


<p>Edit file <code>/etc/onlyoffice/documentserver/nginx/ds.conf</code> and</p>
<ul>
<li>replace <code>{{SSL_CERTIFICATE_PATH}}</code> with <code>/etc/letsencrypt/live/onlyoffice.domain.example/fullchain.pem</code></li>
<li>replace <code>{{SSL_KEY_PATH}}</code> with <code>/etc/letsencrypt/live/onlyoffice.domain.example/privkey.pem</code></li>
</ul>
<p>Be careful each line end with semicolons (<code>;</code>).</p>
<p>Restart OnlyOffice and Nginx:</p>
<div class="codehilite"><pre><span></span>sudo supervisorctl restart all
sudo systemctl restart nginx
</pre></div>


<p>You can now test onlyoffice is accessible from your browser at <code>https://onlyoffice.domain.example</code>.</p>
<h2 id="configure-cozy-stack-for-onlyoffice">Configure cozy-stack for OnlyOffice<a class="headerlink" href="#configure-cozy-stack-for-onlyoffice" title="Permanent link">&para;</a></h2>
<p>Update configuration file:</p>
<div class="codehilite"><pre><span></span>DOMAIN=domain.example
cat <span class="err">&lt;</span><span class="nt">&lt;EOF</span> <span class="err">|</span> <span class="err">sudo</span> <span class="err">tee</span> <span class="err">-a</span> <span class="err">/etc/cozy/cozy.yml</span> <span class="nt">&gt;</span> /dev/null
office:
  default:
    onlyoffice_url: https://onlyoffice.<span class="cp">${</span><span class="n">DOMAIN</span><span class="cp">}</span>/
EOF
</pre></div>


<p>Restart cozy-stack:</p>
<div class="codehilite"><pre><span></span>sudo systemctl restart cozy-stack
</pre></div>


<p>Activate functionality:</p>
<div class="codehilite"><pre><span></span>cozy-stack features defaults &#39;{&quot;drive.office&quot;: {&quot;enabled&quot;: true, &quot;write&quot;: true}}&#39;
</pre></div>


<p>You can now upload an office document in cozy-drive and start editing it online by clicking on it or start a new empty document for the &ldquo;New document&rdquo; menu.</p>
<p>The <code>drive.office</code> feature flag has other options for customising the experience with OnlyOffice:
- <code>enabled</code>: Enables OnlyOffice (OO)
- <code>write</code>: Gives the right to edit. Otherwise OO opens in read mode and a modal is displayed on editing actions to warn that the functionality is blocked
- <code>defaultMode</code>: By default, OO opens in read mode (<code>view</code>). It can be switched to edit with the <code>edit</code> parameter.
- <code>touchScreen</code>: Corresponds to Cozy mobile applications or a browser with a screen width of 1023px or less or a user-agent on an iOS or Android operating system
  * <code>enabled</code>: Enable OnlyOffice (OO)
  * <code>readOnly</code>: Disables edit mode. You can no longer create new documents, only open existing ones in read mode without an edit button
- <code>mobile</code>: Corresponds to the browser with a screen width of 768px or less
  * <code>defaultMode</code>: By default, the opening mode is the same as the main <code>defaultMode</code>. It can be changed to either <code>view</code> reading or <code>edit</code> editing</p>
<p>Example :</p>
<div class="codehilite"><pre><span></span>{
    &quot;enabled&quot;: true,
    &quot;write&quot;: true,
    &quot;defaultMode&quot;: &quot;view&quot;
    &quot;touchScreen&quot;: {
        &quot;enabled&quot;: true
        &quot;readOnly&quot;: false
    },
    &quot;mobile&quot;: {
        &quot;defaultMode&quot;: &quot;view&quot;
    }
}
</pre></div>


<h1 id="update-cozy-stack">Update cozy-stack<a class="headerlink" href="#update-cozy-stack" title="Permanent link">&para;</a></h1>
<p>Applications inside your Cozy are automatically updated, however, cozy-stack application running on your server must be updated from time to time (once every 3 month is a good compromise between too much and too few).
Here is how to upgrade cozy-stack:</p>
<p>Update source code:</p>
<div class="codehilite"><pre><span></span>cd /opt/cozy-stack
sudo git pull
</pre></div>


<p>compile source code:</p>
<div class="codehilite"><pre><span></span>cd /opt/cozy-stack
scripts/build.sh release $(go env GOPATH)/bin/cozy-stack
</pre></div>


<p>You can test compilation produced a valid binary with:</p>
<div class="codehilite"><pre><span></span>$(go env GOPATH)/bin/cozy-stack version
1.5.0-9-g1eac6802
</pre></div>


<p>Install new generated binary:</p>
<div class="codehilite"><pre><span></span>sudo install -o root -g root -m 0755 -T \
             $(go env GOPATH)/bin/cozy-stack /usr/bin/cozy-stack
</pre></div>


<p>Restart cozy-stack:</p>
<div class="codehilite"><pre><span></span>sudo systemctl restart cozy-stack
</pre></div>


<p>Et voilà, you just upgraded cozy-stack to the latest version. pretty easy.</p>
<h1 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h1>
<ul>
<li>CouchDB installation: <a href="https://docs.couchdb.org/en/stable/install/unix.html">https://docs.couchdb.org/en/stable/install/unix.html</a></li>
<li>Go installation: <a href="https://go.dev/doc/install">https://go.dev/doc/install</a></li>
<li>NodeJS installation: <a href="https://github.com/nodesource/distributions/blob/master/README.md#manual-installation">https://github.com/nodesource/distributions/blob/master/README.md#manual-installation</a></li>
<li>Cozy-stack installation: <a href="https://github.com/cozy/cozy-stack/blob/master/docs/INSTALL.md">https://github.com/cozy/cozy-stack/blob/master/docs/INSTALL.md</a></li>
<li>Cozy-stack Configuration Guide: <a href="https://github.com/cozy/cozy-stack/blob/master/docs/config.md">https://github.com/cozy/cozy-stack/blob/master/docs/config.md</a></li>
<li>OnlyOffice installation: <a href="https://helpcenter.onlyoffice.com/installation/docs-community-install-ubuntu.aspx">https://helpcenter.onlyoffice.com/installation/docs-community-install-ubuntu.aspx</a></li>
<li>Configuration https OnlyOffice: <a href="https://helpcenter.onlyoffice.com/installation/docs-community-https-linux.aspx">https://helpcenter.onlyoffice.com/installation/docs-community-https-linux.aspx</a></li>
<li>Cozy-stack office documentation: <a href="https://docs.cozy.io/en/cozy-stack/office/">https://docs.cozy.io/en/cozy-stack/office/</a></li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../selfhost-debian-pkg/" title="on Debian with packages" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                on Debian with packages
              </span>
            </div>
          </a>
        
        
          <a href="../selfhost-ubuntu-sources-fr/" title="on Ubuntu from sources (fr)" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                on Ubuntu from sources (fr)
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../.."}})</script>
      
        <script src="../../../extra.js"></script>
      
    
  </body>
</html>