<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        <meta name="author" content="CozyCloud - https://cozy.io">
        <link rel="canonical" href="https://docs.cozy.io/cozy-stack/permissions/">
        <link rel="shortcut icon" href="../../img/favicon.png">
        
        <title>/permissions - Permissions - Dev Documentation</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
            <link href="../../css/extra.css" rel="stylesheet">
            <link href="../../css/highlight_theme.css" rel="stylesheet">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

	<script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://docs.cozy.io/">Dev Documentation</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="../..">Home</a>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Tutorials <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../tutorials/app/">Create Your Application</a>
</li>
                            
<li >
    <a href="../../tutorials/konnector/">Develop a Connector</a>
</li>
                            
<li >
    <a href="../../tutorials/selfhost-debian/">Self-Host on Debian</a>
</li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">How-to <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
  <li class="dropdown-submenu">
    <a href="#">Dev</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../howTos/dev/runCozyDocker/">Run an App in a Cozy using Docker</a>
</li>
            
<li >
    <a href="../../howTos/dev/hmr/">Use Hot Module Replacement in Your App</a>
</li>
            
<li >
    <a href="../../howTos/dev/cordova/">Make a Mobile App Using Cordova</a>
</li>
            
<li >
    <a href="../../howTos/dev/connect-mobile-app-local-stack/">Connect a Mobile App to Your Local Stack</a>
</li>
            
<li >
    <a href="../../howTos/dev/sendmail/">Send and Receive E-mails in Development</a>
</li>
    </ul>
  </li>
                            
  <li class="dropdown-submenu">
    <a href="#">Synchronize</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../howTos/sync/linux/">Install Cozy Drive on GNU/Linux</a>
</li>
    </ul>
  </li>
                        </ul>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">References <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../../references/tech-intro/">Technical introduction to the Cozy platform</a>
</li>
                            
<li >
    <a href="../../references/git-flow/">Our Front-End Git Flow</a>
</li>
                            
  <li class="dropdown-submenu">
    <a href="#">Stack and tools</a>
    <ul class="dropdown-menu">
            
  <li class="dropdown-submenu">
    <a href="#">cozy-app-publish</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-app-publish/README/">CLI & Workflow</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-apps-registry</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-apps-registry/README/">README</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-client</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-client/getting-started/">Getting started</a>
</li>
            
<li >
    <a href="../../cozy-client/how-tos/">How tos</a>
</li>
            
<li >
    <a href="../../cozy-client/api/cozy-client/">Cozy Client API</a>
</li>
            
<li >
    <a href="../../cozy-client/api/cozy-pouch-link/">Cozy Pouch Link API</a>
</li>
            
<li >
    <a href="../../cozy-client/api/cozy-stack-client/">Cozy Stack Client API</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-client-js</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-client-js/README/">README</a>
</li>
            
<li >
    <a href="../../cozy-client-js/intro/">Introduction</a>
</li>
            
<li >
    <a href="../../cozy-client-js/browser-sdk-transition/">Transition from cozy-browser-sdk</a>
</li>
            
<li >
    <a href="../../cozy-client-js/offline/">How to support offline</a>
</li>
            
<li >
    <a href="../../cozy-client-js/oauth/">OAuth guide</a>
</li>
            
<li >
    <a href="../../cozy-client-js/auth-api/">Authentication API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/data-api/">Data System API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/files-api/">Files API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/jobs-api/">Jobs API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/intents-api/">Intents API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/settings-api/">Settings API</a>
</li>
            
<li >
    <a href="../../cozy-client-js/sharing-api/">Sharing API</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-ui</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-ui/README/">README</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-doctypes</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-doctypes/docs/README/">README</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.accounts/">Accounts</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.photos.albums/">Albums</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.bank/">Banking doctypes</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.bills/">Bills</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.konnectors/">Connectors</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.contacts/">Contacts</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.files/">Files</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.notifications/">Notifications</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.remote.requests/">Remote requests</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.sessions.logins/">Session logins</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.sharings/">Sharings</a>
</li>
            
<li >
    <a href="../../cozy-doctypes/docs/io.cozy.triggers/">Triggers</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-konnector-libs</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-konnector-libs/api/">API</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/cli/">CLI</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/dev/">Develop</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/errors/">Errors</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/operation-linking/">Operation linking</a>
</li>
            
<li >
    <a href="../../cozy-konnector-libs/synchronization/">Synchronization</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-stack</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../README/">README</a>
</li>
            
  <li class="dropdown-submenu">
    <a href="#">Usage</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../INSTALL/">Install the cozy-stack</a>
</li>
            
<li >
    <a href="../config/">Configuration file</a>
</li>
            
<li >
    <a href="../instance/">Managing Instances</a>
</li>
            
<li >
    <a href="../security/">Security</a>
</li>
            
<li >
    <a href="../cli/cozy-stack/">Manpages of the command-line tool</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">How-to guides for developpers</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../client-app-dev/">Develop a client-side app</a>
</li>
            
<li >
    <a href="../docker/">Running and building Docker images</a>
</li>
            
<li >
    <a href="../doctype/">Adding a new doctype</a>
</li>
            
<li >
    <a href="../assets/">Working with the stack assets</a>
</li>
            
<li >
    <a href="../release/">Build a release</a>
</li>
            
<li >
    <a href="../CONTRIBUTING/">The contributing guide</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">Explanations</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../sharing-design/">Sharing design</a>
</li>
            
<li >
    <a href="../konnectors-workflow/">Workflow of the konnectors</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">List of services</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../auth/">/auth - Authentication & OAuth</a>
</li>
            
<li >
    <a href="../apps/">/apps - Applications Management</a>
</li>
            
<li >
    <a href="../registry/"> /apps - Apps registry</a>
</li>
            
<li >
    <a href="../konnectors/"> /apps - Konnectors</a>
</li>
            
<li >
    <a href="../data-system/">/data - Data System</a>
</li>
            
<li >
    <a href="../mango/"> /data - Mango</a>
</li>
            
<li >
    <a href="../couchdb-quirks/"> /data - CouchDB Quirks</a>
</li>
            
<li >
    <a href="../pouchdb-quirks/"> /data - PouchDB Quirks</a>
</li>
            
<li >
    <a href="../files/">/files - Virtual File System</a>
</li>
            
<li >
    <a href="../references-docs-in-vfs/"> /files - References of documents in VFS</a>
</li>
            
<li >
    <a href="../intents/">/intents - Intents</a>
</li>
            
<li >
    <a href="../jobs/">/jobs - Jobs</a>
</li>
            
<li >
    <a href="../workers/"> /jobs - Workers</a>
</li>
            
<li >
    <a href="../move/">/move - Move, export and import an instance</a>
</li>
            
<li >
    <a href="../notifications/">/notifications - Notifications</a>
</li>
            
<li >
    <a href="../public/">/public - Public</a>
</li>
            
<li class="active">
    <a href="./">/permissions - Permissions</a>
</li>
            
<li >
    <a href="../realtime/">/realtime - Realtime</a>
</li>
            
<li >
    <a href="../remote/">/remote - Proxy for remote data/API</a>
</li>
            
<li >
    <a href="../settings/">/settings - Settings</a>
</li>
            
<li >
    <a href="../user-action-required/"> /settings - Terms of Services</a>
</li>
            
<li >
    <a href="../sharing/">/sharings - Sharing</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">konitor</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../konitor/cli/">CLI</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">babel-preset-cozy-app</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../babel-preset-cozy-app/README/">README</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">commitlint-config-cozy</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../commitlint-config-cozy/README/">README</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-device-helper</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-device-helper/README/">README</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">eslint-config-cozy-app</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../eslint-config-cozy-app/README/">README</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-flags</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-flags/README/">README</a>
</li>
    </ul>
  </li>
            
  <li class="dropdown-submenu">
    <a href="#">cozy-realtime</a>
    <ul class="dropdown-menu">
            
<li >
    <a href="../../cozy-realtime/README/">README</a>
</li>
    </ul>
  </li>
    </ul>
  </li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li>
                        <a href="https://github.com/cozy/cozy.github.io/">
                                <i class="fa fa-github"></i>GitHub
                        </a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3 main-toc">
<div class="bs-sidebar hidden-print affix" role="complementary">
    <ul class="nav bs-sidenav well" style='padding-left: 0; padding-right: 0; margin-bottom: 1.5rem'>
        <li class="main active"><a href="#permissions">Permissions</a></li>
            <li><a href="#when-the-permissions-are-used">When the permissions are used?</a></li>
            <li><a href="#what-is-a-permission">What is a permission?</a></li>
            <li><a href="#what-format-for-a-permission">What format for a permission?</a></li>
            <li><a href="#routes">Routes</a></li>
    </ul>
  <div style='padding-left: 2rem'>
    
    <a id='edit-link' href='https://github.com/cozy/cozy.github.io/edit/dev/src/cozy-stack/permissions.md'>Edit documentation</a>
    <script type='text/javascript'>
        /* Here we detect if the current page is from an external documentation and we 
        change the href of the editing link so it goes to the right repository and file */
        const outsideDocs = [{"name": "cozy-app-publish", "repo": "https://github.com/cozy/cozy-app-publish.git", "subdir": "."}, {"name": "cozy-apps-registry", "repo": "https://github.com/cozy/cozy-apps-registry.git", "subdir": "."}, {"name": "cozy-client", "repo": "https://github.com/cozy/cozy-client.git", "subdir": "docs"}, {"name": "cozy-client-js", "repo": "https://github.com/cozy/cozy-client-js.git", "subdir": "docs"}, {"name": "cozy-ui", "repo": "https://github.com/cozy/cozy-ui.git", "subdir": "docs"}, {"name": "cozy-doctypes", "repo": "https://github.com/cozy/cozy-doctypes.git", "subdir": "."}, {"name": "cozy-konnector-libs", "repo": "https://github.com/konnectors/libs.git", "subdir": "packages/cozy-konnector-libs/docs"}, {"name": "cozy-scripts", "repo": "https://github.com/CPatchane/create-cozy-app.git", "subdir": "packages/cozy-scripts/docs"}, {"name": "cozy-stack", "repo": "https://github.com/cozy/cozy-stack.git", "subdir": "docs"}, {"name": "konitor", "repo": "https://github.com/konnectors/konitor.git", "subdir": "docs"}, {"name": "babel-preset-cozy-app", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/babel-preset-cozy-app"}, {"name": "commitlint-config-cozy", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/commitlint-config-cozy"}, {"name": "cozy-device-helper", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/cozy-device-helper"}, {"name": "eslint-config-cozy-app", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/eslint-config-cozy-app"}, {"name": "cozy-flags", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/cozy-flags"}, {"name": "cozy-realtime", "repo": "https://github.com/cozy/cozy-libs.git", "subdir": "packages/cozy-realtime"}]
        const editNode = document.querySelector('#edit-link')
        const pathname = window.location.pathname
        const editURI = 'edit/master/'
        const removeGitSuffix = function (x) { return x.replace(/\.git$/, '') }

        // Returns the external repo associated to a pathname
        const detectExternalRepo = function (pathname) {
            for (var outsideDoc of outsideDocs) {
                if (window.location.pathname.includes('/' + outsideDoc.name + '/')) {
                    return outsideDoc
                }
            }
        }

        // Change the href attribute of a link to point to the correct edition page on GitHub
        // for the passed external documentation
        const fixEditLink = function (editNode, externalDoc) {
            const repoFile = pathname.replace('/en/' + externalDoc.name, '').replace(/\/$/, '.md')
            const baseRepo = removeGitSuffix(externalDoc.repo)
            editNode.href = baseRepo + '/' + editURI + externalDoc.subdir + repoFile
        }

        const externalRepo = detectExternalRepo(pathname)
        if (externalRepo) {
            fixEditLink(editNode, externalRepo)
        }
    </script>
    
  </div>
</div></div>
                <div class="col-md-9" role="main">
                    

<p><a href="../README/#table-of-contents">Table of contents</a></p>
<h1 id="permissions">Permissions<a class="headerlink" href="#permissions" title="Permanent link">&para;</a></h1>
<h2 id="when-the-permissions-are-used">When the permissions are used?<a class="headerlink" href="#when-the-permissions-are-used" title="Permanent link">&para;</a></h2>
<p>The permissions are used when a request is made to cozy stack. It allows to let
the owner of the cozy instance controls the access to her data, files and
actions on them. The permissions are given in several contexts. Let&rsquo;s see them!</p>
<h3 id="client-side-apps">Client-side apps<a class="headerlink" href="#client-side-apps" title="Permanent link">&para;</a></h3>
<p>When the user installs a new client-side app, she is asked to accept an initial
set of permissions for this app. This set of permissions is described in the
manifest of the app.</p>
<p>Later, the application can gain more permissions via the <a href="../intents/">intents</a>
and optional permissions. See below for more details.</p>
<p>When the authentified user access a client-side app, the app receives a token
from the stack that can be used in later requests to the stack as a proof of the
permissions it owns.</p>
<h3 id="external-apps-via-oauth2">External apps via OAuth2<a class="headerlink" href="#external-apps-via-oauth2" title="Permanent link">&para;</a></h3>
<p>An external application can ask for permissions via the OAuth2 dance, and use
them later with the access token. The permissions are in the <code>scope</code> parameter.</p>
<h3 id="sharing-with-other-users">Sharing with other users<a class="headerlink" href="#sharing-with-other-users" title="Permanent link">&para;</a></h3>
<p>The owner of a cozy instance can share some documents and files with other
users. It can be done in two ways:</p>
<ul>
<li>If the other user also has a cozy, it can be a cozy-to-cozy sharing.</li>
<li>Else, the owner can give to him a link with a code or a shortcode.</li>
</ul>
<h2 id="what-is-a-permission">What is a permission?<a class="headerlink" href="#what-is-a-permission" title="Permanent link">&para;</a></h2>
<p>A permission gives the right for a request having it to do something on the
stack. It is defined by four components.</p>
<h3 id="type">Type<a class="headerlink" href="#type" title="Permanent link">&para;</a></h3>
<p><code>type</code> is the attribute used in JSON-API or the <code>docType</code> for the Data System.</p>
<p>It is the only mandatory component. If just the <code>type</code> is specified, it gives
access to all the operations on this <code>type</code>. For example, a permission on type
<code>io.cozy.contacts</code> gives the right to create, read, update and delete any
contact, and to fetch all the contacts. A permission on type <code>io.cozy.files</code>
allow to access and modify any file or directory.</p>
<p>Some known types:</p>
<ul>
<li><code>io.cozy.files</code>, for files and folder in the <a href="../files/">VFS</a></li>
<li><code>io.cozy.apps</code>, for <a href="../apps/">apps</a></li>
<li><code>io.cozy.settings</code>, for the <a href="../settings/">settings</a></li>
<li><code>io.cozy.jobs</code> and <code>io.cozy.triggers</code>, for <a href="../jobs/">jobs</a></li>
<li><code>io.cozy.oauth.clients</code>, to list and revoke <a href="../auth/">OAuth 2 clients</a></li>
</ul>
<h3 id="verbs">Verbs<a class="headerlink" href="#verbs" title="Permanent link">&para;</a></h3>
<p>It says which HTTP verbs can be used for requests to the cozy-stack. <code>GET</code> will
give read-only access, <code>DELETE</code> can be used for deletions, etc. Verbs should be
declared in a list, like <code>["GET", "POST", "DELETE"]</code>, and use <code>["ALL"]</code> as a
shortcut for <code>["GET", "POST", "PUT", "PATCH", "DELETE"]</code> (it is the default).</p>
<p><strong>Note</strong>: <code>HEAD</code> is implicitely implied when <code>GET</code> is allowed. <code>OPTIONS</code> for
Cross-Origin Resources Sharing is always allowed, the stack does not have the
informations about the permission when it answers the request.</p>
<h3 id="values">Values<a class="headerlink" href="#values" title="Permanent link">&para;</a></h3>
<p>It&rsquo;s possible to restrict the permissions to only some documents of a docType,
or to just some files and folders. You can give a list of ids in <code>values</code>.</p>
<p><strong>Note</strong>: a permission for a folder also gives permissions with same verbs for
files and folders inside it.</p>
<h3 id="selector">Selector<a class="headerlink" href="#selector" title="Permanent link">&para;</a></h3>
<p>By default, the <code>values</code> are checked with the <code>id</code>. But it&rsquo;s possible to use a
<code>selector</code> to filter on another <code>field</code>. In particular, it can be used for
sharing. A user may share a calendar and all the events inside it. It will be
done with two permissions. The first one is for the calendar:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.calendars&quot;</span><span class="p">,</span>
    <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
    <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1355812c-d41e-11e6-8467-53be4648e3ad&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>


<p>And the other is for the events inside the calendar:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.events&quot;</span><span class="p">,</span>
    <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
    <span class="nt">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;calendar-id&quot;</span><span class="p">,</span>
    <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;1355812c-d41e-11e6-8467-53be4648e3ad&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>


<h2 id="what-format-for-a-permission">What format for a permission?<a class="headerlink" href="#what-format-for-a-permission" title="Permanent link">&para;</a></h2>
<h3 id="json">JSON<a class="headerlink" href="#json" title="Permanent link">&para;</a></h3>
<p>The prefered format for permissions is JSON. Each permission is a map with the
<code>type</code>, <code>verbs</code>, <code>values</code> and <code>selector</code> see above, plus a <code>description</code> that
can be used to give more informations to the user. Only the <code>type</code> field is
mandatory.</p>
<p>In the manifest, the permissions are regrouped in a map. The key is not very
relevant, it&rsquo;s just here for localization. The same key is used in the <code>locales</code>
field to identify the permission.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;contacts&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Required for autocompletion on @name&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.contacts&quot;</span><span class="p">,</span>
            <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="nt">&quot;images&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Required for the background&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span>
            <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">],</span>
            <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;io.cozy.files.music-dir&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="nt">&quot;mail&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Required to send a congratulations email to your friends&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.jobs&quot;</span><span class="p">,</span>
            <span class="nt">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;worker&quot;</span><span class="p">,</span>
            <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sendmail&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3 id="inline">Inline<a class="headerlink" href="#inline" title="Permanent link">&para;</a></h3>
<p>OAuth2 as a <code>scope</code> parameter for defining the permissions given to the
application. But it&rsquo;s only a string, not a JSON. In that case, we use a space
delimited list of permissions, each permission is written compactly with <code>:</code>
between the components.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span>io.cozy.contacts io.cozy.files:GET:io.cozy.files.music-dir io.cozy.jobs:POST:sendmail:worker
</pre></div>


<p><strong>Note</strong>: the <code>verbs</code> component can&rsquo;t be omitted when the <code>values</code> and
<code>selector</code> are used.</p>
<h3 id="inspiration">Inspiration<a class="headerlink" href="#inspiration" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://news.ycombinator.com/item?id=12784999">Access control on other similar platforms</a></li>
</ul>
<h2 id="routes">Routes<a class="headerlink" href="#routes" title="Permanent link">&para;</a></h2>
<h3 id="get-permissionsself">GET /permissions/self<a class="headerlink" href="#get-permissionsself" title="Permanent link">&para;</a></h3>
<p>List the permissions for a given token</p>
<h4 id="request">Request<a class="headerlink" href="#request" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/permissions/self</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">cozy.example.net</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="response">Response<a class="headerlink" href="#response" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.permissions&quot;</span><span class="p">,</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;5a9c1844-d427-11e6-ab36-2b684d437b0d&quot;</span><span class="p">,</span>
        <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;app&quot;</span><span class="p">,</span>
            <span class="nt">&quot;source_id&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.apps/my-awesome-game&quot;</span><span class="p">,</span>
            <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;contacts&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Required for autocompletion on @name&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.contacts&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="nt">&quot;images&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Required for the background&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
                    <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;io.cozy.files.music-dir&quot;</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="nt">&quot;mail&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Required to send a congratulations email to your friends&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.jobs&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;worker&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sendmail&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3 id="post-permissions">POST /permissions<a class="headerlink" href="#post-permissions" title="Permanent link">&para;</a></h3>
<p>Create a new set of permissions. It can also associates one or more codes to it,
via the <code>codes</code> parameter in the query string. These codes can then be sent to
other people as a way to give these permissions (sharing by links). For each
<code>code</code> created, a corresponding <code>shortcode</code> is generated and can be used to
shorten links for sharing. The <code>code</code> parameter is a comma separed list of
values. The role of these values is to identify the codes if you want to revoke
some of them later. A <code>ttl</code> parameter can also be given to make the codes
expires after a delay (<a href="https://github.com/justincampbell/bigduration/blob/master/README.md">bigduration
format</a>).</p>
<p><strong>Note</strong>: it is only possible to create a strict subset of the permissions
associated to the sent token.</p>
<h4 id="request_1">Request<a class="headerlink" href="#request_1" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">POST</span> <span class="nn">/permissions?codes=bob,jane&amp;ttl=1D</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">cozy.example.net</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.permissions&quot;</span><span class="p">,</span>
        <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;source_id&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.apps/my-awesome-game&quot;</span><span class="p">,</span>
            <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;images&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
                    <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;io.cozy.files.music-dir&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="response_1">Response<a class="headerlink" href="#response_1" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;a340d5e0-d647-11e6-b66c-5fc9ce1e17c6&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.permissions&quot;</span><span class="p">,</span>
        <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;share&quot;</span><span class="p">,</span>
            <span class="nt">&quot;source_id&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.apps/my-awesome-game&quot;</span><span class="p">,</span>
            <span class="nt">&quot;codes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;bob&quot;</span><span class="p">:</span> <span class="s2">&quot;yuot7NaiaeGugh8T&quot;</span><span class="p">,</span>
                <span class="nt">&quot;jane&quot;</span><span class="p">:</span> <span class="s2">&quot;Yohyoo8BHahh1lie&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;shortcodes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;bob&quot;</span><span class="p">:</span> <span class="s2">&quot;abcdeFGHIJ01&quot;</span><span class="p">,</span>
                <span class="nt">&quot;jane&quot;</span><span class="p">:</span> <span class="s2">&quot;123456aBCdef&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;expires_at&quot;</span><span class="p">:</span> <span class="mi">1483951978</span><span class="p">,</span>
            <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;images&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
                    <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;io.cozy.files.music-dir&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3 id="get-permissionsid">GET /permissions/:id<a class="headerlink" href="#get-permissionsid" title="Permanent link">&para;</a></h3>
<p>Return the informations about a set of permissions</p>
<h4 id="request_2">Request<a class="headerlink" href="#request_2" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/permissions/a340d5e0-d647-11e6-b66c-5fc9ce1e17c6</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">cozy.example.net</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="response_2">Response<a class="headerlink" href="#response_2" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;a340d5e0-d647-11e6-b66c-5fc9ce1e17c6&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.permissions&quot;</span><span class="p">,</span>
        <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;share&quot;</span><span class="p">,</span>
            <span class="nt">&quot;source_id&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.apps/my-awesome-game&quot;</span><span class="p">,</span>
            <span class="nt">&quot;codes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;bob&quot;</span><span class="p">:</span> <span class="s2">&quot;yuot7NaiaeGugh8T&quot;</span><span class="p">,</span>
                <span class="nt">&quot;jane&quot;</span><span class="p">:</span> <span class="s2">&quot;Yohyoo8BHahh1lie&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;shortcodes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;bob&quot;</span><span class="p">:</span> <span class="s2">&quot;abcdeFGHIJ01&quot;</span><span class="p">,</span>
                <span class="nt">&quot;jane&quot;</span><span class="p">:</span> <span class="s2">&quot;123456aBCdef&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;expires_at&quot;</span><span class="p">:</span> <span class="mi">1483951978</span><span class="p">,</span>
            <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;images&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
                    <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;io.cozy.files.music-dir&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3 id="patch-permissionsid">PATCH /permissions/:id<a class="headerlink" href="#patch-permissionsid" title="Permanent link">&para;</a></h3>
<p>Add permissions in this permissions set. It can be used in inter-apps context as
a way to give another app the permission for some data. For example, the contact
application can send a &ldquo;<em>pick a photo</em>&rdquo; intent to the photos application with
its permission id, and the photos app can then let the user choose a photo and
give the contacts application the permissions to use it.</p>
<p>It can also be used to add or remove codes.</p>
<h4 id="request-to-add-remove-codes">Request to add / remove codes<a class="headerlink" href="#request-to-add-remove-codes" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">PATCH</span> <span class="nn">/permissions/a340d5e0-d647-11e6-b66c-5fc9ce1e17c6</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">cozy.example.net</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;a340d5e0-d647-11e6-b66c-5fc9ce1e17c6&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.permissions&quot;</span><span class="p">,</span>
        <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;codes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;jane&quot;</span><span class="p">:</span> <span class="s2">&quot;Yohyoo8BHahh1lie&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="request-to-add-permissions">Request to add permissions<a class="headerlink" href="#request-to-add-permissions" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">PATCH</span> <span class="nn">/permissions/a340d5e0-d647-11e6-b66c-5fc9ce1e17c6</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">cozy.example.net</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;a340d5e0-d647-11e6-b66c-5fc9ce1e17c6&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.permissions&quot;</span><span class="p">,</span>
        <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;add-this&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span>
                <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
                <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;some-picture-id&quot;</span><span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="request-to-remove-permissions">Request to remove permissions<a class="headerlink" href="#request-to-remove-permissions" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">PATCH</span> <span class="nn">/permissions/a340d5e0-d647-11e6-b66c-5fc9ce1e17c6</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">cozy.example.net</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;a340d5e0-d647-11e6-b66c-5fc9ce1e17c6&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.permissions&quot;</span><span class="p">,</span>
        <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;remove-this&quot;</span><span class="p">:</span> <span class="p">{}</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="reponse">Reponse<a class="headerlink" href="#reponse" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;a340d5e0-d647-11e6-b66c-5fc9ce1e17c6&quot;</span><span class="p">,</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.permissions&quot;</span><span class="p">,</span>
        <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;share&quot;</span><span class="p">,</span>
            <span class="nt">&quot;source_id&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.apps/my-awesome-game&quot;</span><span class="p">,</span>
            <span class="nt">&quot;codes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;bob&quot;</span><span class="p">:</span> <span class="s2">&quot;yuot7NaiaeGugh8T&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;shortcodes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;bob&quot;</span><span class="p">:</span> <span class="s2">&quot;abcdeFGHIJ01&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;expires_at&quot;</span><span class="p">:</span> <span class="mi">1483951978</span><span class="p">,</span>
            <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;images&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span>
                    <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
                    <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;io.cozy.files.music-dir&quot;</span><span class="p">]</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3 id="delete-permissionsid">DELETE /permissions/:id<a class="headerlink" href="#delete-permissionsid" title="Permanent link">&para;</a></h3>
<p>Delete a set of permissions. For example, some permissions were used by a user
to share a photo album with her friends, and then she changed her mind and
cancel the sharing.</p>
<h4 id="request_3">Request<a class="headerlink" href="#request_3" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">DELETE</span> <span class="nn">/permissions/fa11561c-d645-11e6-83df-cbf577804d55</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">cozy.example.net</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span>
</pre></div>


<h4 id="reponse_1">Reponse<a class="headerlink" href="#reponse_1" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">204</span> <span class="ne">No Content</span>
</pre></div>


<h3 id="post-permissionsexists">POST /permissions/exists<a class="headerlink" href="#post-permissionsexists" title="Permanent link">&para;</a></h3>
<p>List permissions for some documents</p>
<h4 id="request_4">Request<a class="headerlink" href="#request_4" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">POST</span> <span class="nn">/permissions/exists</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">cozy.example.net</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span> <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;94375086-e2e2-11e6-81b9-5bc0b9dd4aa4&quot;</span> <span class="p">}</span>
    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span> <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;4cfbd8be-8968-11e6-9708-ef55b7c20863&quot;</span> <span class="p">}</span>
    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span> <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;a340d5e0-d647-11e6-b66c-5fc9ce1e17c6&quot;</span> <span class="p">}</span>
    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span> <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;94375086-e2e2-11e6-81b9-5bc0b9dd4aa4&quot;</span> <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>


<h4 id="reponse_2">Reponse<a class="headerlink" href="#reponse_2" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span> <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;94375086-e2e2-11e6-81b9-5bc0b9dd4aa4&quot;</span><span class="p">,</span>
      <span class="nt">&quot;verbs&quot;</span><span class="p">:[</span><span class="s2">&quot;GET&quot;</span><span class="p">]</span> <span class="p">}</span>
    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.files&quot;</span><span class="p">,</span> <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;a340d5e0-d647-11e6-b66c-5fc9ce1e17c6&quot;</span><span class="p">,</span>
      <span class="nt">&quot;verbs&quot;</span><span class="p">:[</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">]</span> <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>


<h3 id="patch-permissionsappsslug">PATCH /permissions/apps/:slug<a class="headerlink" href="#patch-permissionsappsslug" title="Permanent link">&para;</a></h3>
<p>Add permissions or remove permissions to the web application with specified
slug. It behaves like the <code>PATCH /permissions/:id</code> route. See this route for
more examples.</p>
<h3 id="patch-permissionskonnectorsslug">PATCH /permissions/konnectors/:slug<a class="headerlink" href="#patch-permissionskonnectorsslug" title="Permanent link">&para;</a></h3>
<p>Add permissions or remove permissions to the konnector with specified slug. It
behaves like the <code>PATCH /permissions/:id</code> route. See this route for more
examples.</p>
<h3 id="get-permissionsdoctypedoctypeshared-by-link">GET /permissions/doctype/:doctype/shared-by-link<a class="headerlink" href="#get-permissionsdoctypedoctypeshared-by-link" title="Permanent link">&para;</a></h3>
<p>List permissions for a doctype that are used for a &ldquo;share by links&rdquo;. This
endpoint is paginated, with a default number of 30 items per page, and a limit
of 100 items per page.</p>
<h4 id="request_5">Request<a class="headerlink" href="#request_5" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/permissions/doctype/io.cozy.events/shared-by-link</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">cozy.example.net</span>
<span class="na">Authorization</span><span class="o">:</span> <span class="l">Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.TJVA95OrM7E2cBab30RMHrHDcEfxjoYZgeFONFh7HgQ</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="reponse_3">Reponse<a class="headerlink" href="#reponse_3" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.permissions&quot;</span><span class="p">,</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;c47f82396d09bfcd270343c5855b30a0&quot;</span><span class="p">,</span>
            <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;share&quot;</span><span class="p">,</span>
                <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;rule0&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.events&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PATCH&quot;</span><span class="p">,</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">],</span>
                        <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c47f82396d09bfcd270343c5855b0eea&quot;</span><span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nt">&quot;codes&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;bob&quot;</span><span class="p">:</span> <span class="s2">&quot;secret&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;shortcodes&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;bob&quot;</span><span class="p">:</span> <span class="s2">&quot;abcdeFGHIJ01&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nt">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;rev&quot;</span><span class="p">:</span> <span class="s2">&quot;1-d46b6358683b80c8d59fc55d6de54127&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;/permissions/c47f82396d09bfcd270343c5855b30a0&quot;</span> <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.permissions&quot;</span><span class="p">,</span>
            <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;c47f82396d09bfcd270343c5855b351a&quot;</span><span class="p">,</span>
            <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;share&quot;</span><span class="p">,</span>
                <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;rule0&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.events&quot;</span><span class="p">,</span>
                        <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
                        <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;c47f82396d09bfcd270343c5855b169b&quot;</span><span class="p">]</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="nt">&quot;codes&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;bob&quot;</span><span class="p">:</span> <span class="s2">&quot;secret&quot;</span>
                <span class="p">},</span>
                <span class="nt">&quot;shortcodes&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="nt">&quot;bob&quot;</span><span class="p">:</span> <span class="s2">&quot;abcdeFGHIJ01&quot;</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="nt">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;rev&quot;</span><span class="p">:</span> <span class="s2">&quot;1-920af658575a56e9e84685f1b09e5c23&quot;</span> <span class="p">},</span>
            <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;/permissions/c47f82396d09bfcd270343c5855b351a&quot;</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>


<p>Permissions required : GET on the whole doctype</p>
                </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <!-- Piwik -->
        <script type="text/javascript">
          var _paq = _paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(['trackPageView']);
          _paq.push(['enableLinkTracking']);
          (function() {
            var u="//matomo.cozycloud.cc/";
            _paq.push(['setTrackerUrl', u+'piwik.php']);
            _paq.push(['setSiteId', '7']);
            var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
            g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
          })();
        </script>
        <noscript><p><img src="//matomo.cozycloud.cc/piwik.php?idsite=7&rec=1" style="border:0;" alt="" /></p></noscript>
        <!-- End Piwik Code -->
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>
        <script src="../../extra.js"></script>
        <script src="../../search/main.js"></script><div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
